<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zpop.web.dao.CommentDao">
  <select id="getComment" resultType= "Comment">
	select * 
	from comment 
	where 
		<if test=" query != null">
		meetingId = #{query}
		</if>
  </select>
  <select id="getReply" resultType= "Comment">
	select * 
	from comment 
	where 
		<if test=" query != null">
		groupId = #{query}
		</if>
  </select>
  <insert id="insertComment" parameterType="java.util.Map">
  	insert into comment 
	  	(meetingId, writerId, content)
	  	values (#{meetingId}, #{writerId}, #{content})
  </insert>
  <insert id="insertReply" parameterType="java.util.Map">
  		insert into comment 
  		<choose>
  			<when test="groupId == null">
				(meetingId, parentCommentId, writerId, content)
				values (#{meetingId}, #{parentCommentId}, #{writerId}, #{content})
			</when>
			<otherwise>
				(meetingId, parentCommentId, groupId, writerId, content)
				values (#{meetingId}, #{parentCommentId}, #{groupId}, #{writerId}, #{content})
			</otherwise>
		</choose>
  </insert>
  <update id="updateComment" parameterType="com.zpop.web.entity.Comment">
  	update comment
  	<set>
      <if test="content != null">content=#{content}</if>
    </set>
  	where id = #{id}
  </update>
  <delete id="deleteComment">
  	delete from comment
  	where id =#{id}
  </delete>
</mapper>


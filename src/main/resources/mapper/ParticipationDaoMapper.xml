<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zpop.web.dao.ParticipationDao">
	<insert id="insert"
		parameterType="com.zpop.web.entity.Participation">
		insert into participation
		(meetingId, participantId)
		values(#{meetingId}, #{participantId})
	</insert>

	<select id="get" resultType="com.zpop.web.entity.Participation">
		select *
		from participation
		where
		id=#{id}
	</select>

	<select id="getListByMeetingId"
		resultType="com.zpop.web.entity.Participation">
		select *
		from participation
		where meetingId=#{id}
	</select>

	<select id="getList"
		resultType="com.zpop.web.entity.Participation">
		select *
		from participation
	</select>
	<select id="getAdminViewList" resultType="AdminParticipationDto">
		SELECT
			participation.id,
			meeting.title,
			meeting.id as meetingId,
			member.profileImagePath,
			member.nickname as participantNickname,
			member.id as participantId,
			participation.createdAt,
			participation.canceledAt
		FROM participation
		JOIN meeting
		ON participation.meetingId = meeting.id
		JOIN member
		ON participation.participantId = member.id
		LIMIT #{offset},#{size}
	</select>
	    <select id="countBySearch" resultType= "java.lang.Integer">
      	SELECT COUNT(id) 
      	FROM participation
    </select>
</mapper>

